[Back to Syllabus](./README.md#course-syllabus)

- Lab 4 overview
    - So far, you used the cats and dogs audio data to generate a binary classifier. The prediction is either a cat or a dog based on the sound. In this lab, you'll use several birdsong CSV files to generate a number of multiclass classification machine learning models. The CSV files have been generated by using the birdsong.py application against the birdsong data set from Kaggle
    - The data set contains .flac audio files, and a Node-RED flow is used to convert the .flac files to .wav files. The flow is available on GitHub
    - There are around 80 birds in the data set but only a few audio files for bird species. The birdsong models work best when a model is detecting only a single bird, but that approach requires 80 models: one for each bird
    - By trial and error, you see that the model performance starts to deteriorate when there are more than 8 birds per model. Consequently, the birds were split into nine categories, and there is a CSV file for each category. All remaining birds are used as negatives (other) in the CSV files
    - In this lab, you create a model for each category. Each model can determine whether a birdsong belongs to a bird within its order, or category, and generates a confidence level. Your application will run an input audio file through all the classification models to provide nine predictions, eight of which should be designated as other with a high level of confidence
    - You will use files that are available as part of the GitHub repository for this course. If you haven’t already, clone the Git repo by opening a command window, creating an appropriate directory, and running this command:
        - ```git clone https://github.com/ibm-early-programs/animal-sounds```

1. Create the first birdsong classification model
      - In this section, you will create your first birdsong classification model based on one of the provided category (order) CSV files
      - You will first create a new machine learning service for the birdsong classification models
      - Be sure you've cloned the birdsong GitHub repo that is used for this course
      - Log in to IBM Watson Studio
      - Click New Project and select Create an empty project to keep the models separate from the cats and dogs
      - Give the new project a name, for example Bird Songs, and a description. Then, click Create
      - Click Assets
      - Using the pane at the right, load one of the provided birdsong CSV files from the repo
      - Select the file to preview it
      - Check that the preview looks like the image with only one row with column names. If it has more than one, the machine learning model creation step will fail
      - Close the preview and return to your project
      - Click Add to Project
      - Click AutoAI experiment
      - Leave the experiment type as From Blank. give the model a name that indicates the type of classifications that it will be predicting against
      - Next you need to associate your Machine Learning service instance to the project
      - Click Associate a Machine learning service instance
      - If you have an existing service, select it from the dropdown list. If not, select the New tab and create a Lite instance
      - Click Select. Then, click Reload and click Create
      - You are then asked to add a data source to the experiment. Click the select button and check the box against the CSV file that you uploaded to the project earlier. Then click Select Asset
      - Select COLUMN1 as the column to predict and all columns as feature columns. If you view the CSV file, you see column 1 is the bird name or other
      - Watson Studio should have automatically selected the prediction type as Multiclass Classification
      - In the Cats and Dogs classification, you only had two classes: cat or dog. Therefore binary classification was the best model to use. In this data set, you have multiple classes of birds (up to 10 per CSV file, so multiclass classification is the best model to use
      - If the prediction type is anything other than multiclass classification, then your data has too many classes for accurate multiclass classification. You may need to edit the CSV to reduce the number of classes i.e. delete some of the bird types. After checking, click on Experimental Settings > Prediction and choose Multiclass from the list
      - Click Run Experiment
      - The experiment works by running the data through different multiclass classification algorithms and ranks them in the pipeline leaderboard. Wait a few moments for this to complete
      - The default scoring criteria to rank the model type is Accuracy (optimized), you can configure this by selecting a different option from the dropdown box at the top of the screen
      - Watson Studio ranks the model with the highest accuracy in first place and outlines the details on any enhancements made to the model
      - Select the model with the best performance.
      - Select the estimator with the best performance. Then, click Save As > Model. Provide a name and description of the model and click Save
      - Your classifier model has now been created. You are now ready to deploy your model to make it accessible as an API
      - Go back to your Birdsongs project in Watson Studio using the breadcrumb. You should now see your model in the Models section
      - Click on the model name and go to the Deployments tab. You should see that you have no current deployments of this model
      - Click Add Deployment, give the deployment a name, and click Save
      - When the status is Ready, you will have a deployment of the classifier against which you can make a prediction
      - If the deployment fails, try refreshing the page. If that doesn’t work, delete the deployment and go back to the overview tab and try again
      - The model has now been deployed

2. Create the remaining birdsong classification models
   - In this section, you create the remaining birdsong classification models based on the provided category (order) CSV files
   - Each instance of a machine learning service can contain 5 deployments, which allows you to add 4 more to your existing instance, before requiring a new one
   - From Watson Studio, click New AutoAI experiment from the Experiments section
   - Name the experiment with the corresponding name of the next birds CSV file. The Watson Machine Learning service should be pre-populated. Click Create
   - On the data source screen, browse your file directory for the birds CSV file. Select the file and wait for it to upload
   - Select COLUMN1 as the column to predict. Check the Prediction Type is Multiclass Classification. If the prediction information looks different to the screenshot, check the steps in the previous lab section on how to fix this
   - Click Run Experiment
   - Wait for the experiment to finish running
   - Click on your best performing estimator and click Save As > Model
   - Go back to your Birdsongs project and select the model from the model section
   - Click Add Deployment. Give the deployment an appropriate name and click Save
   - When your model is deployed, it will have the Ready status
   - Go back to your project and repeat the steps in this section for the remaining CSV files. If you are using the Lite version of Watson Machine Learning, after your 5th model deployment, you will need to go back to the start of Lab 4 and create a new project. This is because only 5 deployments are allowed on the Lite service
   - Before moving onto Node-RED, you need to make a note of your IAM key for the Watson Machine Learning Service(s)
   - Log into IBM Cloud. On your dashboard, click on Resource List and find your Machine Learning service
   - Click on the service name and go to Service Credentials. If there are credentials listed, click on the down arrow and copy the API key, instance ID and URL
   - If there aren't any credentials listed, click New Credential > Add and click on the down arrow and copy the API key, instance ID and URL

//module 3

 - [Go to Next Module](./6_IBM_Watson_Visual_Recognition.md)